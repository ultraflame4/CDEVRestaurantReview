import{p as r,k as b,r as R,a,W as p,j as e,S as f,l as M,D as q,m as S,U as k,f as N,I as m,b as O}from"./index.2c58c893.js";const y="_rating_1p8gv_1",L="_reviewsInput_1p8gv_29",T="_photosList_1p8gv_63",g={rating:y,reviewsInput:L,photosList:T};function D(t){return e(p,{title:"All Photos",icon:"mdi:folder-multiple-image",isOpen:t.isOpen,onClose:t.onClose,children:e("ul",{className:g.photosList,children:t.pictures.map((s,o)=>e("li",{children:e("img",{src:s,alt:"Restaurant Picture"})},o))})})}D.propTypes={isOpen:r.exports.bool.isRequired,pictures:r.exports.arrayOf(r.exports.string).isRequired,onClose:r.exports.func.isRequired};function x(t){const[s,o]=b.useState(t.initialRating),l=R.exports.useRef(null);function u(){l.current!==null&&(l.current.value=t.initialContents.replaceAll("<br>",`
`))}function d(n){let c=n.currentTarget.getBoundingClientRect(),h=n.clientX-c.x,I=Math.ceil(h/c.width*10);o(I)}function w(n){n.buttons===1&&d(n)}function i(){let n=l.current.value;n=n.replaceAll(`
`,"<br>"),M(t.reviewId,s,n).then(c=>{alert("Updated Review!"),window.location.reload()}).catch(c=>{if(c.code===401){alert("Error! Please log in again!"),window.location.reload();return}alert("Error while updating review!")})}return a(p,{title:"Edit Review ",icon:"ic:baseline-edit",isOpen:t.isOpen,onClose:t.onClose,onAfterOpen:u,children:[a("h2",{className:g.rating,children:["Rating: ",e("span",{onClick:d,onMouseMove:w,children:e(f,{rating:s})})]}),e("textarea",{className:g.reviewsInput,ref:l}),e("button",{onClick:i,children:"Save"})]})}x.propTypes={reviewId:r.exports.number.isRequired,initialContents:r.exports.string.isRequired,initialRating:r.exports.number.isRequired,isOpen:r.exports.bool.isRequired,onClose:r.exports.func.isRequired};function _(t){function s(){q(t.reviewId).then(o=>{alert("Deleted Review!"),window.location.reload()}).catch(o=>{if(o.code===401){alert("Error! Please log in again!"),window.location.reload();return}alert("Error submitting review"),console.error(o)})}return a(p,{title:"Delete Review",isOpen:t.isOpen,onClose:t.onClose,children:[a("p",{className:"itemsCenter textRed",style:{fontSize:"1.25rem"},children:["Are you sure you want",e("br",{}),"to delete this review?"]}),e("br",{}),e("br",{}),e("button",{onClick:s,className:"btn-danger",children:"Delete"})]})}_.propTypes={reviewId:r.exports.number.isRequired,isOpen:r.exports.bool.isRequired,onClose:r.exports.func.isRequired};function E(t){const[s,o]=b.useState(0),l=R.exports.useRef(null);function u(i){let n=i.currentTarget.getBoundingClientRect(),c=i.clientX-n.x,h=Math.ceil(c/n.width*10);o(h)}function d(i){i.buttons===1&&u(i)}function w(){let i=l.current.value;if(i.length<20){alert("Review must be at least 20 characters long");return}if(i=i.replace(`
`,"<br>"),s===0){alert("Please select a rating!");return}S(t.restaurantId,s,i).then(n=>{alert("Review submitted!"),window.location.reload()}).catch(n=>{n.code===401&&(alert("Error! Please log in again!"),window.location.reload()),alert("Error submitting review")})}return a(p,{modalId:"write-review",title:"Write a review ",icon:"ic:baseline-edit",children:[a("h2",{className:g.rating,children:["Rating: ",e("span",{onClick:u,onMouseMove:d,children:e(f,{rating:s})})]}),e("textarea",{className:g.reviewsInput,ref:l}),e("button",{onClick:w,children:"Submit"})]})}E.propTypes={restaurantId:r.exports.number.isRequired};const P="_reviewsList_fgsv6_3",A="_editReviewContainer_fgsv6_37",W="_reviewItemHead_fgsv6_111",H="_icon_fgsv6_127",U="_reviewItemRating_fgsv6_171",j="_like_fgsv6_201",v={reviewsList:P,editReviewContainer:A,reviewItemHead:W,icon:H,reviewItemRating:U,like:j},C=t=>{const[s,o]=R.exports.useState(null);let l=new Date(t.last_edit),u=-l.getTimezoneOffset()*1e3*60,d=new Date(l.getTime()+u);function w(){o(0)}function i(){o(1)}function n(){o(null)}return a("li",{children:[t.editable&&a("div",{className:v.editReviewContainer,children:[a("button",{onClick:i,children:["Edit Review ",e(m,{icon:"ic:baseline-edit"})]}),e("button",{onClick:w,children:e(m,{icon:"ic:baseline-delete-forever"})}),e(_,{reviewId:t.reviewId,isOpen:s===0,onClose:n}),e(x,{reviewId:t.reviewId,isOpen:s===1,onClose:n,initialContents:t.content,initialRating:t.rating})]}),a("div",{className:v.reviewItemHead,children:[e(m,{icon:"ic:baseline-account-circle",className:v.icon}),e("h4",{children:t.username}),a("h5",{children:[d.toLocaleDateString(void 0,{dateStyle:"short"})," ",d.toLocaleTimeString(void 0,{timeStyle:"short"})]})]}),e("div",{className:v.reviewItemRating,children:e(f,{rating:t.rating})}),e("p",{children:e(O,{text:t.content,sep:"<br>"})}),a("div",{className:v.like,children:[e(m,{icon:"ic:baseline-thumb-up"}),e("span",{children:t.likes})]})]})};C.propTypes={username:r.exports.string.isRequired,last_edit:r.exports.string.isRequired,rating:r.exports.number.isRequired,content:r.exports.string.isRequired,likes:r.exports.number.isRequired,reviewId:r.exports.number.isRequired,editable:r.exports.bool.isRequired};function B(t){const[s,o]=R.exports.useState([]),[l,u]=R.exports.useState(!1),d=R.exports.useContext(k);function w(){t.loadMore(s.length).then(({reviews:i,allShown:n})=>{o(c=>c.concat(i)),u(n)})}return console.log(t.useRestaurantName,"FFF"),a("ul",{className:v.reviewsList,children:[s.map((i,n)=>{var c;return e(C,{username:t.useRestaurantName?i.restaurant_name:i.username,last_edit:i.last_edit,rating:i.rating,content:i.content,likes:(c=i.likes)!=null?c:0,reviewId:i.id,editable:i.author_id===(d==null?void 0:d.userId)},n)}),e(N,{loadMore:w,hide:l})]})}B.propTypes={loadMore:r.exports.func.isRequired,useRestaurantName:r.exports.bool};export{D as P,B as R,E as W};
